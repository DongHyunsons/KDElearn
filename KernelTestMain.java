package kde_covid_kor.test;

import java.util.ArrayList;
import java.util.Arrays;

import org.apache.log4j.Level;
import org.apache.spark.SparkConf;
import org.apache.spark.api.java.JavaSparkContext;
import org.apache.spark.graphx.*;
import org.apache.spark.sql.SparkSession;

import org.apache.log4j.Logger;

import java.util.List;
import java.util.ArrayList;
import org.apache.spark.api.java.JavaRDD;

public class KernelTest_ {
    public static void main(String[] args){
        
        double[][] table = {{-2.24837908e-01,  4.52798757e-01},
        { 5.62282535e-01,  1.29349814e+00},
        {-3.23552459e-01, -1.43023354e+00},
        {-1.94613340e+00, -9.71196934e-01},
        {-9.34338109e-02, -2.34478814e-01},
        {-2.04686125e+00, -1.05521538e+00},
        { 2.36580867e-01,  5.09000541e-01},
        { 1.89972257e-01, -9.27174461e-01},
        { 6.21226857e-01, -1.15309785e-01},
        { 8.13770077e-01, -1.67665300e-01},
        { 3.26003614e+00, -3.47271280e-01},
        {-1.71281770e+00,  6.44291340e-01},
        {-2.81227522e+00, -4.31625844e-01},
        {-1.49883142e+00, -6.32290121e-01},
        { 1.04159824e-01, -1.18606437e-02},
        {-1.02653875e+00, -3.22778813e-01},
        {-1.01068798e+00,  1.16112881e+00},
        {-5.59101205e-01,  1.06525256e+00},
        {-1.63277337e+00, -3.22879567e-01},
        { 2.07172616e+00, -5.13998061e-01},
        {-1.96434999e-01, -4.06900238e-01},
        { 1.24957842e+00, -4.93962629e-01},
        { 8.00218343e-01, -5.27346401e-01},
        {-6.84278165e-01, -1.55771938e-01},
        {-2.20117218e+00, -9.91633633e-01},
        {-2.53545088e-02,  4.40780366e-01},
        { 3.78256611e-01, -1.23780708e+00},
        {-5.46042150e-01, -7.61102713e-01},
        { 1.21621773e+00,  9.22515650e-01},
        { 5.88878490e-01,  2.96200208e-03},
        {-1.37293947e+00,  4.17972458e-01},
        { 9.21383434e-01,  5.92458779e-01},
        {-7.81865927e-01, -2.28778185e-02},
        {-1.01058865e+00, -7.57326407e-01},
        {-9.73603362e-02,  3.35521429e-01},
        {-2.76771049e-01, -4.53824913e-02},
        { 3.96218998e-01,  1.91599446e-01},
        {-2.03115884e+00, -8.78899575e-01},
        { 2.34810550e+00,  5.30803924e-01},
        { 9.70771771e-01,  1.34658810e+00},
        {-1.12948989e+00, -6.39747862e-01},
        {-1.26759253e+00,  5.32990956e-02},
        { 5.83336085e-01, -6.75887054e-01},
        {-1.64908952e-01, -4.55173904e-03},
        {-2.77670234e+00, -6.67365712e-01},
        {-1.65503940e+00, -6.44462026e-02},
        { 1.50015220e+00,  9.43956162e-01},
        { 1.26288010e+00,  7.19299619e-02},
        { 1.81336746e+00,  5.93123907e-01},
        {-2.08632695e+00,  5.72978676e-01},
        {-1.70625244e+00, -1.17066164e+00},
        {-1.40276911e+00,  1.17186321e-01},
        {-4.01603190e-01, -5.67105709e-01},
        {-3.31389019e+00, -2.82802874e-01},
        { 2.04269526e-02, -1.25585232e+00},
        { 1.59606400e-01, -2.25834604e-01},
        {-2.80200675e-01,  2.54007651e-01},
        {-1.25811215e+00, -6.34069136e-01},
        { 1.71551951e+00, -1.02871321e+00},
        {-8.09472351e-01, -6.75262695e-01},
        { 1.43694819e+00, -1.57507582e-01},
        {-6.23169421e-01,  2.57428755e-01},
        { 1.12489288e+00, -2.33345212e-01},
        {-6.09196106e-02, -1.04943062e+00},
        { 3.27776593e+00, -4.33675828e-02},
        { 8.21749047e-01,  5.70159734e-01},
        {-1.25553082e-01, -4.61658536e-01},
        { 8.01063979e-01, -6.20889199e-02},
        {-1.18835887e+00,  4.07077290e-01},
        { 1.92202237e-01, -6.08171454e-01},
        { 4.74609387e-01, -6.93419454e-01},
        {-2.22242784e-01,  1.92399395e-01},
        {-1.02490561e+00, -4.37952388e-02},
        {-1.70076765e+00, -1.31906698e-02},
        {-9.59249517e-01, -4.48708110e-01},
        {-3.07630700e+00, -3.69019900e-01},
        {-7.57539422e-01,  2.73694447e-01},
        {-7.96044910e-01, -2.36490338e-01},
        {-2.13460187e+00, -1.19834457e+00},
        {-1.76447549e+00, -1.65328535e+00},
        {-2.02309411e+00, -8.21660841e-01},
        { 1.23209824e+00,  2.93413101e-01},
        {-2.05589223e+00,  7.84010554e-02},
        {-1.76356074e+00, -1.56985069e+00},
        {-2.78503285e+00, -1.49351297e+00},
        {-1.19833854e+00,  9.89432889e-01},
        { 3.88847866e-01, -2.09837411e-01},
        { 1.52173954e+00, -4.00971823e-02},
        {-1.53038994e+00,  9.71206562e-02},
        { 3.70692387e+00,  2.38593081e-02},
        {-3.47949966e-01, -2.15106629e-01},
        { 5.00210503e-01,  7.67004992e-01},
        {-5.60396396e-01, -3.01574061e-01},
        {-2.30579549e+00,  7.78864898e-02},
        {-2.45555070e+00, -4.18616066e-01},
        { 1.68702542e+00,  1.23798763e-01},
        { 5.88384105e-01,  4.90010605e-01},
        { 1.42192454e+00, -1.31807888e+00},
        { 4.39037024e-01, -2.90282063e-02},
        {-1.46325985e+00, -4.27089682e-01},
        { 2.11657032e+00,  2.71110602e+00},
        { 3.09753995e+00,  1.85906932e+00},
        { 1.71324567e+00,  2.62985273e+00},
        { 2.35157987e+00,  3.79232565e+00},
        { 9.36927848e-01,  1.36266860e+00},
        { 1.89646120e+00,  2.64430307e+00},
        { 7.22977129e-01,  2.56310696e+00},
        { 4.55118121e+00,  3.14096877e+00},
        { 1.70345918e+00,  1.98511086e+00},
        { 1.68603781e-01,  2.41908703e+00},
        { 3.69930341e+00,  1.94217081e+00},
        { 4.83154067e+00,  2.76460578e+00},
        { 1.55229775e+00,  3.21200676e+00},
        { 1.53607067e+00,  2.80518737e+00},
        { 6.53560375e-01,  1.69745486e+00},
        { 2.32492965e+00,  2.42238210e+00},
        { 6.82696653e-01,  2.60803489e+00},
        { 1.45035979e+00,  1.06162950e+00},
        { 2.41082120e+00,  1.22877502e+00},
        { 2.61293436e+00,  2.80374106e+00},
        { 2.23537218e+00,  2.16421072e+00},
        { 2.47681815e+00,  1.39853507e+00},
        { 1.20084766e+00,  1.97523319e+00},
        { 1.61948588e+00,  2.83384459e+00},
        { 5.59870136e-01,  1.73497433e+00},
        { 1.00950415e+00,  8.98205805e-01},
        { 1.34344121e+00,  1.41463308e+00},
        {-3.93192466e-01,  2.01175544e+00},
        { 2.87778589e+00,  3.39380773e+00},
        { 2.62345607e+00,  2.45625797e+00},
        { 2.97378151e+00,  1.96206260e+00},
        {-5.42210885e-01,  2.40235003e+00},
        { 1.12483316e-02,  8.15924239e-01},
        { 5.06577221e-01,  7.30949197e-01},
        { 7.72933258e-01,  2.62279932e+00},
        { 7.85376141e-01,  2.85864341e+00},
        { 7.07780587e-01,  1.95813259e+00},
        {-3.37797401e-01,  1.91562000e+00},
        { 4.28125410e-01,  1.81520807e+00},
        { 2.33360301e+00,  2.13342486e+00},
        { 3.27532655e+00,  2.34813289e+00},
        { 2.75804904e-01,  2.71965929e+00},
        { 1.02224128e+00,  1.52840505e+00},
        {-1.05133760e+00,  6.86793736e-01},
        { 8.73292051e-01,  1.96692616e+00},
        { 2.07710265e+00,  3.19378808e+00},
        { 3.48640274e+00,  1.11285577e+00},
        { 1.86384425e+00,  3.16456969e+00},
        { 1.47261241e+00,  3.00735961e+00},
        { 2.03302780e+00,  1.72200271e+00},
        {-7.24267927e-01,  2.33578834e+00},
        { 5.02546559e-01,  2.50420320e+00},
        { 6.79794331e-01,  1.61660319e+00},
        { 1.43530104e+00,  2.07752620e+00},
        { 1.53371377e+00,  2.90070927e+00},
        { 2.92205054e+00,  3.18818349e+00},
        { 3.49963803e+00,  2.58790826e+00},
        { 1.78771961e+00,  2.65818343e+00},
        { 5.11408809e-01,  1.13333272e+00},
        { 4.99816003e-01,  1.32494772e+00},
        { 2.03227316e+00,  2.43596399e+00},
        { 5.07038814e-01,  1.11354285e+00},
        { 2.78591727e+00,  1.90376402e+00},
        {-1.85258009e+00,  8.51751210e-01},
        { 2.57509962e+00,  1.26162032e+00},
        { 1.46170853e+00,  1.66355648e+00},
        { 1.27618754e+00,  2.16909636e+00},
        { 1.19307453e+00,  2.37869532e+00},
        { 5.90927823e-01,  1.57217471e+00},
        {-8.48061084e-01,  5.10696303e-01},
        { 8.13914726e-01,  2.28091624e+00},
        { 6.33589537e-01,  1.49077689e+00},
        { 1.44110572e+00,  1.89682120e+00},
        { 1.92007119e+00,  2.36061523e+00},
        { 9.71579439e-01,  2.08016723e+00},
        { 2.81186430e+00,  1.80514502e+00},
        {-1.23980794e+00,  1.88091158e+00},
        { 1.83638931e+00,  1.57444209e+00},
        {-1.96256566e-01,  1.71820237e+00},
        { 1.26771318e+00,  7.41530698e-01},
        {-8.65326568e-01,  3.05733330e+00},
        { 1.51004522e+00,  1.71867702e+00},
        { 1.78849692e+00,  1.63549055e+00},
        { 2.25328371e+00,  1.06198659e+00},
        {-3.50288425e-01,  2.51422433e+00},
        { 8.89910395e-01,  2.55798685e+00},
        { 1.40121882e+00,  7.38500033e-01},
        { 2.36955172e+00,  2.92807446e+00},
        { 2.78767970e+00,  2.55542561e+00},
        {-6.94327893e-01,  4.58267113e-01},
        { 2.39681528e+00,  1.62394916e+00},
        { 9.85363679e-01,  1.77253385e+00},
        { 5.56833050e-01,  1.86544281e+00},
        { 8.23265174e-01,  2.23267246e+00},
        { 3.40984619e+00,  2.63444532e+00},
        { 1.25195358e+00,  3.25699409e+00},
        {-8.26776368e-01,  2.32646961e+00},
        { 4.58831853e+00,  2.74151372e+00},
        {-2.22091956e+00,  2.05937229e+00},
        { 1.77513352e+00,  2.11356303e+00}};
        double[] weight = new double[200] ;
        Arrays.fill(weight,0.1);
        weight[150] = 10000;
        Logger.getLogger("org.apache").setLevel(Level.WARN);
        SparkSession session =SparkSession.builder().appName("Test").master("local[*]").getOrCreate();
        JavaSparkContext sc = new JavaSparkContext(session.sparkContext());

        KernelDensity kd = new KernelDensity(sc,table);
        
        for(int i=100;i>0;i--){
            double y = (double)i/16.5 -2;
            for(int j=0;j<100;j++){
                double x = (double)j/12.5 -3;
                System.out.print( Math.round(kd.p(x,y)*100000 ) /100000.+"\t");
                //System.out.print(Math.round(x*100)/100.0+" "+Math.round(y*100)/100.0+"      ");
                
            }
            System.out.println("///////");
        }
        
        /*
        for (int i=0; i<200 ; i++)
            System.out.print(weight[i]);
        System.out.println("////");
        System.out.println(table[150][0]);
        System.out.println(table[150][1]);
        */
        sc.close();
    }
}